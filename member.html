<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <style>
    body { display: none !important; }
  </style>

  <script>
    // 2. ç«‹å³æª¢æŸ¥ç™»å…¥ç‹€æ…‹ï¼Œæ²’ç™»å…¥ç›´æ¥è¸¢èµ°
    (function() {
      const user = localStorage.getItem('loggedInUser');
      if (!user) {
        alert("æ‚¨å°šæœªç™»å…¥ï¼Œè«‹ç™»å…¥å¾ŒæŸ¥çœ‹å€‹äººè³‡æ–™ï¼");
        window.location.href = "loging.html";
      }
    })();

    // 3. å®šç¾©ç™»å‡ºå‡½æ•¸ (æ”¾åœ¨å…¨åŸŸï¼Œç¢ºä¿ HTML é»æ“Šå¾—åˆ°)
    function handleLogout() {
      if (confirm("ç¢ºå®šè¦ç™»å‡º K-Chords å—ï¼Ÿ")) {
        localStorage.removeItem('loggedInUser');
        window.location.href = "loging.html";
      }
    }
  </script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>K-Chords | æœƒå“¡ä¸­å¿ƒ</title>
  <link rel="stylesheet" href="css/member.css?v=1.4" />
</head>
<body>
  <header>
    <div class="header-inner">
      <h1><a href="index.html">K-Chords | K-å’Œå¼¦</a></h1>
      <div class="nav-container">
        <div class="search-wrapper">
          <input type="text" id="searchInput" class="search-bar" placeholder="æœå°‹å•†å“ã€åœ˜å..." />
          <div id="searchResults" class="search-results"></div>
        </div>
        <nav>
          <ul>
            <li><a href="cart.html">è³¼ç‰©è»Š</a></li>
            <li><a href="loging.html">æœƒå“¡è¨»å†Š/ç™»å…¥</a></li>
            <li><a href="member.html">æœƒå“¡è³‡æ–™</a></li>
            <li><a href="javascript:void(0)" class="nav-logout-text" onclick="handleLogout()" style="color:red;">ç™»å‡º</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <nav class="member-nav">
    <ul class="member-nav-ul">
      <li class="active"><a href="member.html">å€‹äººè³‡è¨Š</a></li>
      <li><a href="points.html">æœƒå“¡é»æ•¸</a></li>
      <li><a href="oldorders.html">è¨‚å–®</a></li>
      <li><a href="wishlist.html">è¿½è¹¤æ¸…å–®</a></li>
    </ul>
  </nav>

  <div class="profile-container">
    <div class="member-header-box">
      <div class="user-main">
        <span class="user-icon">ğŸ‘¤</span>
        <span class="user-name" id="display-name">è¼‰å…¥ä¸­...</span>
        <span class="user-badge">ä¸€èˆ¬æœƒå“¡</span>
      </div>
      <div class="upgrade-info">
        <div class="upgrade-text">
          <p>ğŸ å‡ç´šè‡³æ–°æ˜Ÿæœƒå“¡ï¼Œäº«è³¼ç‰© 97 æŠ˜ã€‚</p>
        </div>
      </div>
    </div>

    <div class="info-section">
      <h3><span class="icon">ğŸ‘¤</span> æœƒå“¡è³‡æ–™</h3>
      <div class="form-group">
        <label>å§“å</label>
        <input type="text" id="edit-name">
      </div>
      <div class="form-group">
        <label>é›»éƒµ</label>
        <input type="email" id="display-email">
      </div>
      <div class="form-group">
        <label>æ‰‹æ©Ÿè™Ÿç¢¼</label>
        <div class="phone-input-group">
          <select><option>TW +886</option></select>
          <input type="text" id="member-phone">
        </div>
      </div>
      <div class="form-group">
        <label>æ€§åˆ¥</label>
        <select id="member-gender">
          <option>å¥³</option>
          <option>ç”·</option>
          <option>ä¸ä¾¿é€éœ²</option>
        </select>
      </div>
      <div class="form-group">
        <label>ç”Ÿæ—¥æ—¥æœŸ</label>
        <div class="birthday-group">
          <select id="birth-year"><option value="">å¹´</option></select>
          <select id="birth-month"><option value="">æœˆ</option></select>
          <select id="birth-day"><option value="">æ—¥</option></select>
        </div>
      </div>
      <div class="form-group">
  <label>è¯çµ¡é›»è©± (é€è²¨ç”¨)</label>
  <input type="text" id="shipping-phone" placeholder="0912 345 678">
</div>
<div class="form-group">
  <label>7-11 å–è²¨é–€å¸‚</label>
  <div style="display: flex; gap: 10px;">
    <input type="text" id="store-name" placeholder="é–€å¸‚åç¨±" style="flex: 2;">
    <input type="text" id="store-number" placeholder="åº—è™Ÿ(6ç¢¼)" style="flex: 1;">
  </div>
</div>
      <button class="edit-btn">æ›´æ–°æœƒå“¡è³‡æ–™</button>
      <div class="logout-area" style="margin-top:20px; text-align:center;">
        <button type="button" class="logout-danger-btn" onclick="handleLogout()">ç™»å‡ºå¸³è™Ÿ</button>
      </div>
    </div>

    <div class="history-section">
      <h3><span class="icon">ğŸ’¬</span> æ­·å²è©•è«–ç´€éŒ„</h3>
      <div id="reviews-container"></div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="footer-box">
      <div class="footer-col">
        <h3>K-Chords | K-å’Œå¼¦</h3>
        <a href="https://www.instagram.com/uyhnz/" target="_blank">IG:K.Chords_official</a>
        <p>å•†å“å•é¡Œä¹Ÿå¯ä»¥ä¾†é€™è£¡è©¢å•</p>
        <a href="aboutus.html">é—œæ–¼æˆ‘å€‘</a>
      </div>
      <div class="footer-col">
        <h3>SERVICE</h3>
        <a href="afterservice.html">é€€æ›è²¨æœå‹™ After-sales service</a>
        <a href="qa.html">å¸¸è¦‹å•é¡Œ Q&A</a>
      </div>
      <div class="footer-col">
        <h3>COMPANY</h3>
        <a href="contact.html">è¯çµ¡æˆ‘å€‘</a>
        <a href="cooperate.html">åˆä½œæ´½è«‡</a>
        <a href="privacy.html">éš±ç§æ”¿ç­–</a>
        <a href="anti-fraud.html">åè©é¨™å…¬å‘Š</a>
        <p class="footer-time">å®¢æœæ™‚é–“ Mon.â€“Fri. 10:00â€“18:00 (ä¸å«ä¾‹å‡æ—¥)</p>
      </div>
    </div>
    <div class="footer-bottom">
      Â© 2026 K-Chords | K-å’Œå¼¦ All rights reserved.
    </div>
  </footer>

  <script>
    // 1. å®šç¾©ç™»å‡ºå‡½æ•¸ (å…¨åŸŸ)
    function handleLogout() {
      if (confirm("ç¢ºå®šè¦ç™»å‡º K-Chords å—ï¼Ÿ")) {
        localStorage.removeItem('loggedInUser');
        window.location.href = "loging.html";
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      // 2. æª¢æŸ¥ç™»å…¥ç‹€æ…‹
      const user = localStorage.getItem('loggedInUser');
      
      if (!user) {
        window.location.href = "loging.html";
        return; 
      }

      // 3. è§£é™¤éš±è—
      document.body.style.setProperty('display', 'block', 'important');

      // 4. å®šç¾©æ‰€æœ‰æ¬„ä½ ID
      const fields = [
        'edit-name', 'display-email', 'member-phone', 
        'shipping-phone', 'member-gender', 'birth-year', 
        'birth-month', 'birth-day', 'store-name', 'store-number'
      ];

      // 5. åˆå§‹åŒ–é¡¯ç¤ºï¼šå°‡ç™»å…¥å¸³è™Ÿå¡«å…¥ã€Œå§“åã€èˆ‡ã€Œé¡¯ç¤ºåç¨±ã€
      // å¦‚æœæœ¬åœ°ç«¯æ²’æœ‰å­˜éã€Œä¿®æ”¹å¾Œçš„å§“åã€ï¼Œå°±é è¨­é¡¯ç¤ºç™»å…¥å¸³è™Ÿ
      const savedName = localStorage.getItem('edit-name');
      const finalName = savedName ? savedName : user;

      document.getElementById('display-name').textContent = finalName;
      document.getElementById('edit-name').value = finalName;

      // 6. è®€å–å…¶ä»–å„²å­˜è³‡æ–™ (é›»éƒµã€é›»è©±ã€é–€å¸‚ç­‰)
      fields.forEach(id => {
        if (id === 'edit-name') return; // å§“åå·²åœ¨ä¸Šé¢è™•ç†é
        const savedValue = localStorage.getItem(id);
        const element = document.getElementById(id);
        if (savedValue && element) element.value = savedValue;
      });

      // 7. æ¸²æŸ“è©•è«–ç´€éŒ„
      const reviewsContainer = document.getElementById('reviews-container');
      if (reviewsContainer) {
        const productReviews = JSON.parse(localStorage.getItem('productReviews')) || [];
        if (productReviews.length === 0) {
          reviewsContainer.innerHTML = '<p style="color:#666; text-align:center;">ç›®å‰å°šç„¡è©•è«–ç´€éŒ„ã€‚</p>';
        } else {
          reviewsContainer.innerHTML = productReviews.map(review => `
  <div class="comment-item" style="border-bottom: 1px solid #333; padding: 10px 0;">
    <div class="comment-header">
      <strong style="color: #D4AF37;">ğŸ“¦ å•†å“ï¼š${review.productName}</strong>
      <span style="color: #f1c40f; margin-left: 10px;">${'â˜…'.repeat(review.star)}${'â˜†'.repeat(5 - review.star)}</span>
    </div>
    <div class="comment-content" style="margin: 5px 0;">ã€Œ${review.content}ã€</div>
    <div class="comment-footer" style="font-size: 12px; color: #888;">
      ğŸ“… æ—¥æœŸï¼š${review.date ? review.date : new Date().toISOString().split('T')[0]}
    </div>
  </div>
`).join('');
        }
      }

      // 8. ç”Ÿæˆç”Ÿæ—¥é¸å–®
      const yearSelect = document.getElementById('birth-year');
      const monthSelect = document.getElementById('birth-month');
      const daySelect = document.getElementById('birth-day');
      if (yearSelect) for (let i = 2026; i >= 1950; i--) yearSelect.options.add(new Option(i, i));
      if (monthSelect) for (let i = 1; i <= 12; i++) monthSelect.options.add(new Option(i, i));
      if (daySelect) for (let i = 1; i <= 31; i++) daySelect.options.add(new Option(i, i));

      // 9. æ›´æ–°æŒ‰éˆ•èˆ‡å½ˆçª—é©—è­‰é‚è¼¯
      const updateBtn = document.querySelector('.edit-btn');
      if (updateBtn) {
        updateBtn.addEventListener('click', function(e) {
          e.preventDefault();

          const name = document.getElementById('edit-name').value.trim();
          const mPhone = document.getElementById('member-phone').value.trim();
          const sPhone = document.getElementById('shipping-phone').value.trim();
          const sNum = document.getElementById('store-number').value.trim();

          // --- å½ˆçª—é©—è­‰å€ ---
          if (name === "") { 
            alert("å§“åä¸èƒ½ç‚ºç©ºï¼"); 
            return; 
          }
          
          // é©—è­‰æ‰‹æ©Ÿè™Ÿç¢¼ (æœƒå“¡è³‡æ–™)
          if (mPhone !== "" && !/^\d{10}$/.test(mPhone)) { 
            alert("æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼éŒ¯èª¤ï¼Œéœ€ç‚º 10 ä½æ•¸å­—ï¼"); 
            return; 
          }

          // é©—è­‰è¯çµ¡é›»è©± (é€è²¨ç”¨) -> ä½ çš„éœ€æ±‚ 1
          if (sPhone !== "" && !/^\d{10}$/.test(sPhone)) { 
            alert("é€è²¨è¯çµ¡é›»è©±æ ¼å¼éŒ¯èª¤ï¼Œéœ€ç‚º 10 ä½æ•¸å­—ï¼"); 
            return; 
          }

          // é©—è­‰é–€å¸‚åº—è™Ÿ
          if (sNum !== "" && !/^\d{6}$/.test(sNum)) { 
            alert("é–€å¸‚åº—è™Ÿæ ¼å¼éŒ¯èª¤ï¼Œéœ€ç‚º 6 ä½æ•¸å­—ï¼"); 
            return; 
          }

          // åŸ·è¡Œå„²å­˜
          fields.forEach(id => {
            const el = document.getElementById(id);
            if (el) localStorage.setItem(id, el.value);
          });

          // åŒæ­¥æ›´æ–°ç™»å…¥ç‹€æ…‹çš„åå­—
          localStorage.setItem('loggedInUser', name); 
          
          alert("æœƒå“¡è³‡æ–™å·²æ›´æ–°ï¼");
          location.reload();
        });
      }
    });

  </script>
  <script>
const products = [
  { id: 6, name: "CORTIS 2026 å¹´æ›†", keywords: ["cortis","å¹´æ›†","å®˜æ–¹å°ˆè¼¯"] },
  { id: 7, name: "NMIXX 2026 å¹´æ›†", keywords: ["nmixx","å¹´æ›†"] },
  { id: 8, name: "TXT 2026 å¹´æ›†", keywords: ["txt","å¹´æ›†"] },
  { id: 9, name: "IZNA 2026 å¹´æ›†", keywords: ["izna","å¹´æ›†"] },
  { id: 10, name: "KISS OF LIFE 2026 å¹´æ›†", keywords: ["kiss","kiof","å¹´æ›†"] },
  { id: 14, name: "å®˜æ–¹å‘¨é‚Šå¥—çµ„", keywords: ["å‘¨é‚Š","é…ä»¶"] }
];

const input = document.getElementById("searchInput");
const resultBox = document.getElementById("searchResults");

input.addEventListener("input", function () {
  const keyword = input.value.toLowerCase().trim();
  resultBox.innerHTML = "";
  if (!keyword) {
    resultBox.style.display = "none";
    return;
  }

  const matches = products.filter(p =>
    p.name.toLowerCase().includes(keyword) ||
    p.keywords.some(k => k.includes(keyword))
  );

  if (matches.length === 0) {
    resultBox.innerHTML = `<div>æ‰¾ä¸åˆ°ç›¸é—œå•†å“</div>`;
  } else {
    matches.forEach(p => {
      const div = document.createElement("div");
      div.textContent = p.name;
      div.onclick = () => {
        window.location.href = `product.html?id=${p.id}`;
      };
      resultBox.appendChild(div);
    });
  }

  resultBox.style.display = "block";
});

document.addEventListener("click", function (e) {
  if (!e.target.closest(".search-wrapper")) {
    resultBox.style.display = "none";
  }
});
</script>
</body>
</html>